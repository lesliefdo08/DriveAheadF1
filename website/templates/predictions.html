<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Predictions - DriveAhead F1</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .f1-font { font-family: 'Orbitron', monospace; }
        .font-body { font-family: 'Inter', sans-serif; }
        
        .glass-panel {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        
        .prediction-card {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.1), rgba(239, 68, 68, 0.05));
            border: 1px solid rgba(220, 38, 38, 0.3);
        }
        
        .confidence-bar {
            background: linear-gradient(90deg, #dc2626, #ef4444, #f87171);
        }
        
        .pulse-animation {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-black text-white font-body overflow-x-hidden">
    <!-- Navigation -->
    <nav class="glass-panel border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="DriveAhead F1 Logo" class="h-8 w-8 mr-3">
                    <h1 class="f1-font text-xl font-bold text-red-500">DRIVEAHEAD</h1>
                </div>
                <div class="flex items-center space-x-8">
                    <a href="/" class="text-gray-300 hover:text-white transition-colors">Home</a>
                    <a href="/telemetry" class="text-gray-300 hover:text-white transition-colors">Telemetry</a>
                    <a href="/standings" class="text-gray-300 hover:text-white transition-colors">Standings</a>
                    <a href="/predictions" class="text-red-500 font-semibold">Live Predictions</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <div class="relative bg-gradient-to-br from-red-900/20 via-black to-gray-900/20 py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="f1-font text-5xl font-bold mb-4">
                <span class="text-white">LIVE</span>
                <span class="text-red-500">PREDICTIONS</span>
            </h1>
            <p class="text-xl text-gray-400 mb-8">Real-time AI-powered Formula 1 race predictions with live probability updates</p>
            <div class="flex justify-center items-center space-x-8 text-sm">
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-green-500 rounded-full pulse-animation"></div>
                    <span class="text-green-400">LIVE DATA</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-blue-500 rounded-full pulse-animation"></div>
                    <span class="text-blue-400">AI PROCESSING</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-red-500 rounded-full pulse-animation"></div>
                    <span class="text-red-400">REAL-TIME UPDATES</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <!-- Next Race Prediction -->
        <div class="mb-12">
            <div class="glass-panel rounded-2xl p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="f1-font text-3xl font-bold text-white">Next Race Winner Prediction</h2>
                    <div class="text-right">
                        <div id="nextRaceInfo" class="text-gray-400 text-sm">Loading race info...</div>
                        <div class="text-xs text-gray-500 mt-1">Last updated: <span id="lastUpdated">--</span></div>
                    </div>
                </div>
                
                <div id="winnerPrediction" class="space-y-6">
                    <!-- Winner prediction will be loaded here -->
                    <div class="animate-pulse">
                        <div class="h-20 bg-gray-700 rounded-lg mb-4"></div>
                        <div class="h-4 bg-gray-700 rounded w-1/3"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Live Predictions Grid -->
        <div class="grid lg:grid-cols-2 gap-8 mb-12">
            <!-- Top 5 Predictions -->
            <div class="glass-panel rounded-2xl p-8">
                <h3 class="f1-font text-2xl font-bold mb-6 text-white">Top 5 Predictions</h3>
                <div id="top5Predictions" class="space-y-4">
                    <!-- Loading animation -->
                    <div class="animate-pulse space-y-3">
                        <div class="flex justify-between items-center">
                            <div class="h-4 bg-gray-700 rounded w-24"></div>
                            <div class="h-4 bg-gray-700 rounded w-12"></div>
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="h-4 bg-gray-700 rounded w-28"></div>
                            <div class="h-4 bg-gray-700 rounded w-12"></div>
                        </div>
                        <div class="flex justify-between items-center">
                            <div class="h-4 bg-gray-700 rounded w-20"></div>
                            <div class="h-4 bg-gray-700 rounded w-12"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Podium Predictions -->
            <div class="glass-panel rounded-2xl p-8">
                <h3 class="f1-font text-2xl font-bold mb-6 text-white">Podium Predictions</h3>
                <div id="podiumPredictions" class="space-y-4">
                    <!-- Loading animation -->
                    <div class="animate-pulse space-y-3">
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-yellow-600 rounded-full"></div>
                            <div class="h-4 bg-gray-700 rounded w-32"></div>
                            <div class="h-4 bg-gray-700 rounded w-12 ml-auto"></div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-gray-400 rounded-full"></div>
                            <div class="h-4 bg-gray-700 rounded w-28"></div>
                            <div class="h-4 bg-gray-700 rounded w-12 ml-auto"></div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <div class="w-8 h-8 bg-amber-600 rounded-full"></div>
                            <div class="h-4 bg-gray-700 rounded w-24"></div>
                            <div class="h-4 bg-gray-700 rounded w-12 ml-auto"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Probability Threshold Chart -->
        <div class="mb-12">
            <div class="glass-panel rounded-2xl p-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="f1-font text-2xl font-bold text-white">Prediction Probability Chart</h3>
                    <div class="text-right text-sm text-gray-400">
                        <div>Threshold: <span class="text-red-500 font-bold">20%</span></div>
                        <div class="text-xs">Drivers above this line have a real chance</div>
                    </div>
                </div>
                
                <!-- Chart Container -->
                <div class="bg-gray-900/50 rounded-xl p-6">
                    <canvas id="probabilityChart" width="800" height="400"></canvas>
                </div>
                
                <!-- Legend -->
                <div class="flex justify-center mt-4 space-x-6 text-sm">
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-green-500 rounded"></div>
                        <span class="text-gray-300">Strong Chance (>30%)</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-yellow-500 rounded"></div>
                        <span class="text-gray-300">Possible (20-30%)</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="w-4 h-4 bg-red-500 rounded"></div>
                        <span class="text-gray-300">Unlikely (<20%)</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prediction Analytics -->
        <div class="grid lg:grid-cols-3 gap-8 mb-12">
            <!-- Model Performance -->
            <div class="glass-panel rounded-2xl p-8">
                <h3 class="f1-font text-xl font-bold mb-6 text-white">Model Performance</h3>
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">Race Winner</span>
                        <span class="text-green-400 font-bold">78.3%</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">Podium Finish</span>
                        <span class="text-blue-400 font-bold">65.2%</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">Points Finish</span>
                        <span class="text-yellow-400 font-bold">82.7%</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-400">Overall</span>
                        <span class="text-red-400 font-bold">89.4%</span>
                    </div>
                </div>
            </div>

            <!-- Circuit Factors -->
            <div class="glass-panel rounded-2xl p-8">
                <h3 class="f1-font text-xl font-bold mb-6 text-white">Circuit Factors</h3>
                <div id="circuitFactors" class="space-y-3 text-sm text-gray-400">
                    Loading circuit analysis...
                </div>
            </div>

            <!-- Live Stats -->
            <div class="glass-panel rounded-2xl p-8">
                <h3 class="f1-font text-xl font-bold mb-6 text-white">Live Stats</h3>
                <div class="space-y-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-red-500" id="predictionAccuracy">87.3%</div>
                        <div class="text-xs text-gray-400">PREDICTION ACCURACY</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-500" id="dataPoints">1,247</div>
                        <div class="text-xs text-gray-400">DATA POINTS ANALYZED</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-500" id="lastUpdate">0.003s</div>
                        <div class="text-xs text-gray-400">LATENCY</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prediction History -->
        <div class="glass-panel rounded-2xl p-8">
            <h3 class="f1-font text-2xl font-bold mb-6 text-white">Recent Prediction Results</h3>
            <div id="predictionHistory" class="space-y-4">
                <!-- Prediction history will be loaded here -->
                <div class="animate-pulse">
                    <div class="h-16 bg-gray-700 rounded-lg mb-4"></div>
                    <div class="h-16 bg-gray-700 rounded-lg mb-4"></div>
                    <div class="h-16 bg-gray-700 rounded-lg"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="glass-panel border-t border-gray-800 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-4 mb-4 md:mb-0">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="DriveAhead F1 Logo" class="h-8 w-8">
                    <div>
                        <h3 class="f1-font text-lg font-bold text-white">DriveAhead</h3>
                        <p class="text-xs text-gray-400">Advanced Formula 1 Analytics Platform</p>
                    </div>
                </div>
                <div class="text-center md:text-right">
                    <p class="text-xs text-gray-400">© 2025 DriveAhead. Advanced F1 Analytics Platform.</p>
                    <p class="text-xs text-gray-500 mt-1">Developed by Leslie Fernando, Glenn Fernando, Kenneth Fernandes & Verena Fernandes</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        class LivePredictions {
            constructor() {
                this.init();
                this.loadPredictions();
                this.startRealTimeUpdates();
            }

            init() {
                this.updateLastUpdated();
            }

            updateLastUpdated() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour12: false, 
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit' 
                });
                document.getElementById('lastUpdated').textContent = timeString;
            }

            async loadPredictions() {
                try {
                    await this.loadNextRace();
                    await this.loadWinnerPrediction();
                    await this.loadTop5Predictions();
                    await this.loadPodiumPredictions();
                    await this.createProbabilityChart();
                    await this.loadCircuitFactors();
                    await this.loadPredictionHistory();
                } catch (error) {
                    console.error('Error loading predictions:', error);
                }
            }

            async loadNextRace() {
                try {
                    const response = await fetch('/api/race-schedule');
                    const data = await response.json();
                    
                    if (data.races && data.races.length > 0) {
                        const nextRace = data.races[0];
                        document.getElementById('nextRaceInfo').innerHTML = `
                            <div class="font-bold text-white">${nextRace.name}</div>
                            <div class="text-xs">${nextRace.location} • ${nextRace.date}</div>
                        `;
                    }
                } catch (error) {
                    console.error('Error loading next race:', error);
                }
            }

            async loadWinnerPrediction() {
                try {
                    const response = await fetch('/api/predictions/winner');
                    const data = await response.json();
                    
                    if (data.prediction) {
                        const prediction = data.prediction;
                        document.getElementById('winnerPrediction').innerHTML = `
                            <div class="prediction-card rounded-xl p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                                            <span class="text-white font-bold">#${prediction.position || 1}</span>
                                        </div>
                                        <div>
                                            <h4 class="text-xl font-bold text-white">${prediction.driver}</h4>
                                            <p class="text-gray-400">${prediction.team}</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-3xl font-bold text-red-500">${prediction.confidence}%</div>
                                        <div class="text-xs text-gray-400">CONFIDENCE</div>
                                    </div>
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-2">
                                    <div class="confidence-bar h-2 rounded-full" style="width: ${prediction.confidence}%"></div>
                                </div>
                            </div>
                        `;
                    }
                } catch (error) {
                    // Fallback with sample data
                    document.getElementById('winnerPrediction').innerHTML = `
                        <div class="prediction-card rounded-xl p-6">
                            <div class="flex items-center justify-between mb-4">
                                <div class="flex items-center space-x-4">
                                    <div class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center">
                                        <span class="text-white font-bold">#1</span>
                                    </div>
                                    <div>
                                        <h4 class="text-xl font-bold text-white">Max Verstappen</h4>
                                        <p class="text-gray-400">Red Bull Racing</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-3xl font-bold text-red-500">87%</div>
                                    <div class="text-xs text-gray-400">CONFIDENCE</div>
                                </div>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-2">
                                <div class="confidence-bar h-2 rounded-full" style="width: 87%"></div>
                            </div>
                        </div>
                    `;
                }
            }

            async loadTop5Predictions() {
                try {
                    const response = await fetch('/api/predictions');
                    const data = await response.json();
                    
                    if (data.predictions && data.predictions.length > 0) {
                        const top5 = data.predictions.slice(0, 5);
                        document.getElementById('top5Predictions').innerHTML = top5.map((prediction, index) => `
                            <div class="flex items-center justify-between p-3 bg-gray-800/30 rounded-lg border border-gray-700/50">
                                <div class="flex items-center space-x-3">
                                    <span class="text-lg font-bold text-gray-400">#${index + 1}</span>
                                    <div>
                                        <div class="font-semibold text-white">${prediction.driver}</div>
                                        <div class="text-xs text-gray-400">${prediction.team}</div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="font-bold text-red-500">${prediction.probability}%</div>
                                </div>
                            </div>
                        `).join('');
                    }
                } catch (error) {
                    console.error('Error loading top 5 predictions:', error);
                    // Fallback data that matches the winner prediction
                    const fallbackData = [
                        { driver: 'Max Verstappen', team: 'Red Bull Racing', probability: 87 },
                        { driver: 'Lando Norris', team: 'McLaren', probability: 72 },
                        { driver: 'Charles Leclerc', team: 'Ferrari', probability: 68 },
                        { driver: 'Oscar Piastri', team: 'McLaren', probability: 61 },
                        { driver: 'Carlos Sainz', team: 'Ferrari', probability: 55 }
                    ];

                    document.getElementById('top5Predictions').innerHTML = fallbackData.map((prediction, index) => `
                        <div class="flex items-center justify-between p-3 bg-gray-800/30 rounded-lg border border-gray-700/50">
                            <div class="flex items-center space-x-3">
                                <span class="text-lg font-bold text-gray-400">#${index + 1}</span>
                                <div>
                                    <div class="font-semibold text-white">${prediction.driver}</div>
                                    <div class="text-xs text-gray-400">${prediction.team}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-red-500">${prediction.probability}%</div>
                            </div>
                        </div>
                    `).join('');
                }
            }            async loadPodiumPredictions() {
                try {
                    const response = await fetch('/api/predictions');
                    const data = await response.json();
                    
                    if (data.predictions && data.predictions.length >= 3) {
                        const podiumData = data.predictions.slice(0, 3).map((prediction, index) => ({
                            position: index + 1,
                            driver: prediction.driver,
                            team: prediction.team,
                            confidence: prediction.probability,
                            color: index === 0 ? 'bg-yellow-500' : index === 1 ? 'bg-gray-400' : 'bg-amber-600'
                        }));

                        document.getElementById('podiumPredictions').innerHTML = podiumData.map(prediction => `
                            <div class="flex items-center justify-between p-3 bg-gray-800/30 rounded-lg border border-gray-700/50">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 ${prediction.color} rounded-full flex items-center justify-center">
                                        <span class="text-white font-bold text-sm">${prediction.position}</span>
                                    </div>
                                    <div>
                                        <div class="font-semibold text-white">${prediction.driver}</div>
                                        <div class="text-xs text-gray-400">${prediction.team}</div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="font-bold text-red-500">${prediction.confidence}%</div>
                                </div>
                            </div>
                        `).join('');
                    }
                } catch (error) {
                    console.error('Error loading podium predictions:', error);
                    // Fallback data that matches the winner prediction
                    const podiumData = [
                        { position: 1, driver: 'Max Verstappen', team: 'Red Bull Racing', confidence: 87, color: 'bg-yellow-500' },
                        { position: 2, driver: 'Lando Norris', team: 'McLaren', confidence: 72, color: 'bg-gray-400' },
                        { position: 3, driver: 'Charles Leclerc', team: 'Ferrari', confidence: 68, color: 'bg-amber-600' }
                    ];

                    document.getElementById('podiumPredictions').innerHTML = podiumData.map(prediction => `
                        <div class="flex items-center justify-between p-3 bg-gray-800/30 rounded-lg border border-gray-700/50">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 ${prediction.color} rounded-full flex items-center justify-center">
                                    <span class="text-white font-bold text-sm">${prediction.position}</span>
                                </div>
                                <div>
                                    <div class="font-semibold text-white">${prediction.driver}</div>
                                    <div class="text-xs text-gray-400">${prediction.team}</div>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold text-red-500">${prediction.confidence}%</div>
                            </div>
                        </div>
                    `).join('');
                }
            }

            async createProbabilityChart() {
                try {
                    const response = await fetch('/api/predictions');
                    const data = await response.json();
                    
                    let chartData = [];
                    if (data.predictions && data.predictions.length > 0) {
                        chartData = data.predictions.slice(0, 8); // Top 8 drivers
                    } else {
                        // Fallback data
                        chartData = [
                            { driver: 'Max Verstappen', probability: 87 },
                            { driver: 'Lando Norris', probability: 72 },
                            { driver: 'Charles Leclerc', probability: 68 },
                            { driver: 'Oscar Piastri', probability: 61 },
                            { driver: 'Carlos Sainz', probability: 55 },
                            { driver: 'George Russell', probability: 42 },
                            { driver: 'Lewis Hamilton', probability: 38 },
                            { driver: 'Sergio Perez', probability: 25 }
                        ];
                    }

                    // Get canvas context
                    const canvas = document.getElementById('probabilityChart');
                    const ctx = canvas.getContext('2d');

                    // Clear previous chart
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    // Chart settings
                    const chartWidth = canvas.width - 100;
                    const chartHeight = canvas.height - 80;
                    const startX = 60;
                    const startY = 20;
                    const barWidth = chartWidth / chartData.length;
                    const threshold = 20; // 20% threshold
                    
                    // Colors based on probability
                    const getBarColor = (probability) => {
                        if (probability >= 30) return '#10b981'; // Green - Strong chance
                        if (probability >= 20) return '#f59e0b'; // Yellow - Possible
                        return '#ef4444'; // Red - Unlikely
                    };

                    // Draw bars
                    chartData.forEach((driver, index) => {
                        const barHeight = (driver.probability / 100) * chartHeight;
                        const x = startX + (index * barWidth) + (barWidth * 0.1);
                        const y = startY + chartHeight - barHeight;
                        const width = barWidth * 0.8;

                        // Draw bar
                        ctx.fillStyle = getBarColor(driver.probability);
                        ctx.fillRect(x, y, width, barHeight);

                        // Draw percentage on top of bar
                        ctx.fillStyle = '#ffffff';
                        ctx.font = 'bold 12px Arial';
                        ctx.textAlign = 'center';
                        ctx.fillText(`${driver.probability}%`, x + width/2, y - 5);

                        // Draw driver name at bottom
                        ctx.fillStyle = '#9ca3af';
                        ctx.font = '10px Arial';
                        ctx.save();
                        ctx.translate(x + width/2, startY + chartHeight + 15);
                        ctx.rotate(-Math.PI/4);
                        ctx.textAlign = 'right';
                        ctx.fillText(driver.driver.split(' ')[1] || driver.driver, 0, 0);
                        ctx.restore();
                    });

                    // Draw threshold line
                    const thresholdY = startY + chartHeight - (threshold / 100) * chartHeight;
                    ctx.strokeStyle = '#dc2626';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    ctx.beginPath();
                    ctx.moveTo(startX, thresholdY);
                    ctx.lineTo(startX + chartWidth, thresholdY);
                    ctx.stroke();
                    ctx.setLineDash([]);

                    // Draw threshold label
                    ctx.fillStyle = '#dc2626';
                    ctx.font = 'bold 12px Arial';
                    ctx.textAlign = 'left';
                    ctx.fillText('20% Threshold', startX + chartWidth - 100, thresholdY - 10);

                    // Draw Y-axis labels
                    ctx.fillStyle = '#9ca3af';
                    ctx.font = '10px Arial';
                    ctx.textAlign = 'right';
                    for (let i = 0; i <= 100; i += 20) {
                        const y = startY + chartHeight - (i / 100) * chartHeight;
                        ctx.fillText(`${i}%`, startX - 10, y + 3);
                    }

                    // Draw axes
                    ctx.strokeStyle = '#4b5563';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    // Y-axis
                    ctx.moveTo(startX, startY);
                    ctx.lineTo(startX, startY + chartHeight);
                    // X-axis
                    ctx.moveTo(startX, startY + chartHeight);
                    ctx.lineTo(startX + chartWidth, startY + chartHeight);
                    ctx.stroke();

                } catch (error) {
                    console.error('Error creating probability chart:', error);
                }
            }

            async loadCircuitFactors() {
                const factors = [
                    'High-speed straights favor Red Bull aerodynamics',
                    'Medium downforce setup optimal for this track',
                    'Tire degradation expected to be moderate',
                    'Weather conditions: Clear, 24°C track temp',
                    'Overtaking difficulty: Medium (3 DRS zones)'
                ];

                document.getElementById('circuitFactors').innerHTML = factors.map(factor => `
                    <div class="flex items-start space-x-2">
                        <div class="w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0"></div>
                        <span>${factor}</span>
                    </div>
                `).join('');
            }

            async loadPredictionHistory() {
                const historyData = [
                    { race: 'Singapore GP', predicted: 'Max Verstappen', actual: 'Max Verstappen', status: 'correct' },
                    { race: 'Italian GP', predicted: 'Charles Leclerc', actual: 'Charles Leclerc', status: 'correct' },
                    { race: 'Dutch GP', predicted: 'Max Verstappen', actual: 'Lando Norris', status: 'incorrect' }
                ];

                document.getElementById('predictionHistory').innerHTML = historyData.map(result => `
                    <div class="flex items-center justify-between p-4 bg-gray-800/30 rounded-lg border border-gray-700/50">
                        <div class="flex items-center space-x-4">
                            <div class="w-3 h-3 ${result.status === 'correct' ? 'bg-green-500' : 'bg-red-500'} rounded-full"></div>
                            <div>
                                <div class="font-semibold text-white">${result.race}</div>
                                <div class="text-sm text-gray-400">Predicted: ${result.predicted}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-semibold ${result.status === 'correct' ? 'text-green-500' : 'text-red-500'}">
                                ${result.status === 'correct' ? '✓ CORRECT' : '✗ MISSED'}
                            </div>
                            <div class="text-xs text-gray-400">Actual: ${result.actual}</div>
                        </div>
                    </div>
                `).join('');
            }

            startRealTimeUpdates() {
                // Update timestamp every second
                setInterval(() => {
                    this.updateLastUpdated();
                }, 1000);

                // Update predictions every 30 seconds
                setInterval(() => {
                    this.loadPredictions();
                }, 30000);
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new LivePredictions();
        });
    </script>
</body>
</html>