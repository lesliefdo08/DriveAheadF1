<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriveAhead F1 - Advanced Formula 1 Analytics Platform</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .f1-font { font-family: 'Orbitron', monospace; }
        .animate-pulse-slow { animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        .gradient-bg {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0f0f0f 100%);
        }
        .glass-panel {
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .f1-glow {
            box-shadow: 0 0 20px rgba(255, 30, 30, 0.3);
        }
        .countdown-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .countdown-segment {
            text-align: center;
            background: linear-gradient(145deg, rgba(220, 38, 38, 0.15), rgba(239, 68, 68, 0.1));
            border: 2px solid rgba(220, 38, 38, 0.4);
            border-radius: 16px;
            padding: 1.5rem 1rem;
            min-width: 100px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .countdown-segment:hover {
            border-color: rgba(220, 38, 38, 0.6);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.2);
        }
        
        .countdown-segment::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .countdown-segment:hover::before {
            left: 100%;
        }
        
        .countdown-number {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: 900;
            color: #ef4444;
            display: block;
            line-height: 1;
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }
        
        .countdown-label {
            font-size: 0.75rem;
            color: #9ca3af;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-top: 0.5rem;
        }
            background: linear-gradient(145deg, #1a1a1a, #0f0f0f);
            border: 1px solid #333;
            box-shadow: inset 0 1px 3px rgba(255,255,255,0.1);
        }
        @keyframes slideInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .slide-in { animation: slideInUp 0.6s ease-out forwards; }
        .hero-text {
            background: linear-gradient(45deg, #ff1e1e, #ffffff, #0090ff);
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Countdown Number Transitions */
        .countdown-number {
            transition: all 0.2s ease-in-out;
        }
        
        /* Smooth animation pulse for countdown status */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
        }
    </style>
</head>
<body class="bg-black text-white min-h-screen overflow-x-hidden">
    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-black/90 backdrop-blur-lg border-b border-red-500/20">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="DriveAhead F1 Logo" class="h-8 w-8">
                    <span class="f1-font text-xl font-bold text-white">DriveAhead</span>
                    <span class="text-xs bg-red-600 px-2 py-1 rounded-full">LIVE</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="/" class="text-red-500 font-semibold transition-colors">Home</a>
                    <a href="/telemetry" class="text-gray-300 hover:text-red-500 transition-colors">Live Telemetry</a>
                    <a href="/standings" class="text-gray-300 hover:text-red-500 transition-colors">Standings</a>
                    <a href="/predictions" class="text-gray-300 hover:text-red-500 transition-colors">Live Predictions</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="min-h-screen flex items-center justify-center relative overflow-hidden">
        <!-- Animated Background -->
        <div class="absolute inset-0">
            <div class="absolute top-1/4 left-1/4 w-32 h-32 border border-red-500/30 rounded-full animate-pulse-slow"></div>
            <div class="absolute bottom-1/4 right-1/4 w-24 h-24 border border-blue-500/30 rounded-full animate-pulse-slow" style="animation-delay: 1s;"></div>
            <div class="absolute top-1/2 left-1/2 w-16 h-16 border border-yellow-500/30 rounded-full animate-pulse-slow" style="animation-delay: 2s;"></div>
            <div class="absolute inset-0 bg-gradient-to-br from-red-500/5 via-transparent to-blue-500/5"></div>
        </div>
        
        <div class="container mx-auto px-6 text-center z-10">
            <div class="slide-in">
                <h1 class="f1-font text-7xl md:text-9xl font-black mb-6 hero-text">
                    DriveAhead
                </h1>
                <p class="text-2xl md:text-4xl font-light mb-4 text-gray-300">
                    F1 Analytics & Probability Engine
                </p>
                <p class="text-lg text-gray-400 mb-12 max-w-3xl mx-auto">
                    Explore how machine learning interprets F1 data to calculate win probabilities. Track live standings, compare statistical favorites to race results, and dive into the beautiful chaos of Formula 1.
                </p>
                
                <!-- CTA Buttons -->
                <div class="flex flex-col sm:flex-row gap-6 justify-center items-center mb-16">
                    <a href="/predictions" class="bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-8 rounded-lg text-lg transition-all duration-300 transform hover:scale-105 f1-glow">
                        <i class="fas fa-brain mr-2"></i>View Probabilities
                    </a>
                    <a href="/standings" class="border-2 border-gray-600 hover:border-red-500 text-white font-bold py-4 px-8 rounded-lg text-lg transition-all duration-300 transform hover:scale-105">
                        <i class="fas fa-trophy mr-2"></i>Live Standings
                    </a>
                </div>
                
                <!-- Stats -->
                <div class="grid grid-cols-3 gap-8 max-w-2xl mx-auto">
                    <div class="text-center">
                        <div class="f1-font text-3xl font-bold text-red-500">97.0%</div>
                        <div class="text-sm text-gray-400">MODEL ACCURACY</div>
                    </div>
                    <div class="text-center">
                        <div class="f1-font text-3xl font-bold text-blue-500">3 AI</div>
                        <div class="text-sm text-gray-400">ALGORITHMS</div>
                    </div>
                    <div class="text-center">
                        <div class="f1-font text-3xl font-bold text-green-500">2025</div>
                        <div class="text-sm text-gray-400">LIVE SEASON</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Next Race Section -->
    <section id="next-race" class="py-20 bg-gradient-to-b from-black to-gray-900">
        <div class="container mx-auto px-6">
            <div class="max-w-6xl mx-auto">
                <h2 class="f1-font text-4xl font-bold text-center mb-12 text-white">Next Race</h2>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Race Info -->
                    <div class="glass-panel rounded-2xl p-8">
                        <div id="nextRaceInfo" class="space-y-4">
                            <div class="animate-pulse">
                                <div class="h-6 bg-gray-700 rounded w-3/4 mb-3"></div>
                                <div class="h-4 bg-gray-700 rounded w-1/2 mb-2"></div>
                                <div class="h-4 bg-gray-700 rounded w-2/3"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Countdown Timer -->
                    <div class="glass-panel rounded-2xl p-8">
                        <div class="text-center">
                            <div id="raceNameCountdown" class="text-sm text-gray-400 mb-6">Loading...</div>
                            <div id="countdownStatus" class="text-white text-lg font-semibold mb-4">NEXT RACE COUNTDOWN</div>
                            <div class="countdown-container">
                                <div class="countdown-segment">
                                    <span id="countdownDays" class="countdown-number">--</span>
                                    <div class="countdown-label">DAYS</div>
                                </div>
                                <div class="countdown-segment">
                                    <span id="countdownHours" class="countdown-number">--</span>
                                    <div class="countdown-label">HOURS</div>
                                </div>
                                <div class="countdown-segment">
                                    <span id="countdownMinutes" class="countdown-number">--</span>
                                    <div class="countdown-label">MINUTES</div>
                                </div>
                                <div class="countdown-segment">
                                    <span id="countdownSeconds" class="countdown-number">--</span>
                                    <div class="countdown-label">SECONDS</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Upcoming Race Calendar -->
                <div class="mt-12">
                    <h3 class="f1-font text-2xl font-bold mb-6 text-center text-white">UPCOMING RACE CALENDAR</h3>
                    <div class="text-center text-sm text-gray-400 mb-4">All times shown in IST (Indian Standard Time)</div>
                    <div class="glass-panel rounded-2xl p-6">
                        <div id="upcomingRaces" class="space-y-4">
                            <div class="text-center text-gray-400">
                                Loading race schedule...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Analytics Section -->
    <section id="analytics" class="py-20 bg-gray-900">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="f1-font text-4xl font-bold mb-4 text-white">Why DriveAhead?</h2>
                <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                    For fans who want live F1 data. For students learning ML. For developers building portfolios. For anyone who loves racing analytics.
                </p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- For F1 Fans -->
                <div class="glass-panel rounded-xl p-6 hover:transform hover:scale-105 transition-all duration-300">
                    <div class="text-center">
                        <i class="fas fa-flag-checkered text-4xl text-red-500 mb-4"></i>
                        <h3 class="f1-font text-xl font-bold mb-3 text-white">For F1 Fans</h3>
                        <p class="text-gray-400 mb-6 text-sm">
                            Live 2025 season data with race countdowns, up-to-date standings, and probability insights. See which drivers ML favors and compare favorites to actual race chaos.
                        </p>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <div class="f1-font text-lg font-bold text-red-500">LIVE</div>
                                <div class="text-xs text-gray-400">2025 DATA</div>
                            </div>
                            <div>
                                <div class="f1-font text-lg font-bold text-red-500">24/7</div>
                                <div class="text-xs text-gray-400">UPDATES</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- For Students -->
                <div class="glass-panel rounded-xl p-6 hover:transform hover:scale-105 transition-all duration-300">
                    <div class="text-center">
                        <i class="fas fa-graduation-cap text-4xl text-blue-500 mb-4"></i>
                        <h3 class="f1-font text-xl font-bold mb-3 text-white">For Students</h3>
                        <p class="text-gray-400 mb-6 text-sm">
                            Learn how ML interprets sports statistics. See Random Forest, XGBoost, and Logistic Regression in action. Understand probability vs certainty in unpredictable domains.
                        </p>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <div class="f1-font text-lg font-bold text-blue-500">3 AI</div>
                                <div class="text-xs text-gray-400">ALGORITHMS</div>
                            </div>
                            <div>
                                <div class="f1-font text-lg font-bold text-blue-500">97%</div>
                                <div class="text-xs text-gray-400">ACCURACY</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- For Developers -->
                <div class="glass-panel rounded-xl p-6 hover:transform hover:scale-105 transition-all duration-300">
                    <div class="text-center">
                        <i class="fas fa-code text-4xl text-green-500 mb-4"></i>
                        <h3 class="f1-font text-xl font-bold mb-3 text-white">For Developers</h3>
                        <p class="text-gray-400 mb-6 text-sm">
                            Full-stack ML deployment: Flask backend, real-time API integration, model training pipeline, professional F1 broadcast UI, and production deployment on Render.
                        </p>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <div class="f1-font text-lg font-bold text-green-500">FULL</div>
                                <div class="text-xs text-gray-400">STACK ML</div>
                            </div>
                            <div>
                                <div class="f1-font text-lg font-bold text-green-500">PROD</div>
                                <div class="text-xs text-gray-400">DEPLOYED</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Probability vs Reality -->
                <div class="glass-panel rounded-xl p-6 hover:transform hover:scale-105 transition-all duration-300">
                    <div class="text-center">
                        <i class="fas fa-chart-line text-4xl text-yellow-500 mb-4"></i>
                        <h3 class="f1-font text-xl font-bold mb-3 text-white">Probability Analytics</h3>
                        <p class="text-gray-400 mb-6 text-sm">
                            This isn't fortune telling—it's statistical analysis. Track championship leader probabilities vs unpredictable race outcomes. When favorites lose, racing gets exciting!
                        </p>
                        <div class="grid grid-cols-2 gap-4 text-center">
                            <div>
                                <div class="f1-font text-lg font-bold text-yellow-500">STATS</div>
                                <div class="text-xs text-gray-400">NOT MAGIC</div>
                            </div>
                            <div>
                                <div class="f1-font text-lg font-bold text-yellow-500">CHAOS</div>
                                <div class="text-xs text-gray-400">IS EXCITING</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- AI Predictions Section -->
    <section id="predictions" class="py-20 bg-black">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="f1-font text-4xl font-bold mb-4 text-white">ML Probability Engine</h2>
                <p class="text-xl text-gray-400">Three-algorithm ensemble calculating statistical favorites—not guaranteeing winners</p>
            </div>
            
            <div class="grid lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                <!-- Next Race Winner Prediction -->
                <div class="lg:col-span-2">
                    <div class="glass-panel rounded-2xl p-8">
                        <h3 class="f1-font text-2xl font-bold mb-6 text-white">Next Race Winner Prediction</h3>
                        <div id="winnerPrediction" class="space-y-6">
                            <div class="animate-pulse">
                                <div class="h-20 bg-gray-700 rounded-lg mb-4"></div>
                                <div class="h-4 bg-gray-700 rounded w-1/3"></div>
                            </div>
                        </div>
                        
                        <!-- Key Circuit Factors -->
                        <div class="mt-8">
                            <h4 class="f1-font text-lg font-bold mb-4 text-gray-300">Key Circuit Factors</h4>
                            <div id="circuitFactors" class="text-gray-400">
                                Loading...
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Top 5 Contenders -->
                <div>
                    <div class="glass-panel rounded-2xl p-8">
                        <h3 class="f1-font text-2xl font-bold mb-6 text-white">Top 5 Contenders</h3>
                        <div id="topContenders" class="space-y-4">
                            <div class="animate-pulse space-y-3">
                                <div class="flex justify-between items-center">
                                    <div class="h-4 bg-gray-700 rounded w-24"></div>
                                    <div class="h-4 bg-gray-700 rounded w-12"></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="h-4 bg-gray-700 rounded w-28"></div>
                                    <div class="h-4 bg-gray-700 rounded w-12"></div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <div class="h-4 bg-gray-700 rounded w-20"></div>
                                    <div class="h-4 bg-gray-700 rounded w-12"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI Model Performance -->
            <div class="mt-12">
                <div class="glass-panel rounded-2xl p-8">
                    <h3 class="f1-font text-2xl font-bold mb-8 text-center text-white">AI Model Performance</h3>
                    <div class="grid md:grid-cols-4 gap-8 text-center">
                        <div>
                            <div class="f1-font text-3xl font-bold text-green-500 mb-2">78.3%</div>
                            <div class="text-sm text-gray-400">Overall RACE WINNER</div>
                        </div>
                        <div>
                            <div class="f1-font text-3xl font-bold text-blue-500 mb-2">65.2%</div>
                            <div class="text-sm text-gray-400">PODIUM FINISH</div>
                        </div>
                        <div>
                            <div class="f1-font text-3xl font-bold text-yellow-500 mb-2">82.7%</div>
                            <div class="text-sm text-gray-400">POINTS FINISH</div>
                        </div>
                        <div>
                            <div class="f1-font text-3xl font-bold text-red-500 mb-2">89.4%</div>
                            <div class="text-sm text-gray-400">ACCURACY TREND</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Data Stream Section -->
    <section id="data" class="py-20 bg-gray-900">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="f1-font text-4xl font-bold mb-4 text-white">Live F1 Data Stream</h2>
                <p class="text-xl text-gray-400">Real-time data from current F1 season</p>
            </div>
            
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Driver Standings -->
                <div class="glass-panel rounded-xl p-6">
                    <h3 class="f1-font text-xl font-bold mb-4 text-red-500 flex items-center">
                        <i class="fas fa-trophy mr-2"></i>Driver Standings
                    </h3>
                    <div id="driverStandings" class="space-y-3">
                        <div class="text-gray-400">Loading standings...</div>
                    </div>
                </div>
                
                <!-- Constructor Standings -->
                <div class="glass-panel rounded-xl p-6">
                    <h3 class="f1-font text-xl font-bold mb-4 text-blue-500 flex items-center">
                        <i class="fas fa-car mr-2"></i>Constructor Standings
                    </h3>
                    <div id="constructorStandings" class="space-y-3">
                        <div class="text-gray-400">Loading standings...</div>
                    </div>
                </div>
                
                <!-- Latest Race Results -->
                <div class="glass-panel rounded-xl p-6">
                    <h3 class="f1-font text-xl font-bold mb-4 text-green-500 flex items-center">
                        <i class="fas fa-flag-checkered mr-2"></i>Latest Race Results
                    </h3>
                    <div id="latestRaceResults" class="space-y-3">
                        <div class="text-gray-400">Loading race results...</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black py-12 border-t border-gray-800">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-4 gap-8">
                <div class="md:col-span-2">
                    <div class="flex items-center space-x-3 mb-4">
                        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="DriveAhead F1 Logo" class="h-8 w-8">
                        <span class="f1-font text-2xl font-bold">DriveAhead</span>
                    </div>
                    <p class="text-gray-400 mb-4">
                        Advanced Formula 1 Analytics Platform powered by cutting-edge machine learning and real-time data processing.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-red-500 transition-colors">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-red-500 transition-colors">
                            <i class="fab fa-youtube text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-red-500 transition-colors">
                            <i class="fab fa-instagram text-xl"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h4 class="f1-font font-bold mb-4 text-white">Technology</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li>Jolpica F1 API</li>
                        <li>Python & Flask</li>
                        <li>JavaScript & HTML5</li>
                        <li>Chart.js Visualizations</li>
                        <li>Real-time Data Processing</li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="f1-font font-bold mb-4 text-white">Features</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li>Live Telemetry</li>
                        <li>Race Predictions</li>
                        <li>Strategy Analysis</li>
                        <li>Performance Metrics</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-8 pt-8 text-center">
                <p class="text-gray-400">© 2025 DriveAhead. Advanced F1 Analytics Platform.</p>
                <p class="text-sm text-gray-500 mt-2">Developed by Leslie Fernando, Glenn Fernando, Kenneth Fernandes & Verena Fernandes</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Home Page Data Manager
        class HomePageManager {
            constructor() {
                this.init();
                this.loadAllData();
                
                // Refresh data every 30 seconds
                setInterval(() => {
                    this.loadAllData();
                }, 30000);
            }

            async init() {
                // Start loading all data in parallel
                await Promise.all([
                    this.loadNextRace(),
                    this.loadUpcomingRaces(),
                    this.loadStandings(),
                    this.loadPredictions(),
                    this.loadLatestRaceResults()
                ]);
            }

            async loadAllData() {
                try {
                    await Promise.all([
                        this.loadNextRace(),
                        this.loadUpcomingRaces(),
                        this.loadStandings(),
                        this.loadPredictions(),
                        this.loadLatestRaceResults()
                    ]);
                } catch (error) {
                    console.error('Error loading data:', error);
                }
            }

            async loadNextRace() {
                try {
                    const response = await fetch('/api/next-race');
                    const data = await response.json();
                    
                    if (data.race) {
                        const race = data.race;
                        // Store race name globally for countdown display
                        window.currentRaceName = race.name;
                        
                        document.getElementById('nextRaceInfo').innerHTML = `
                            <div class="space-y-4">
                                <h3 class="f1-font text-2xl font-bold text-white">${race.name}</h3>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-map-marker-alt mr-2 text-red-500"></i>
                                    <span>${race.location}</span>
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-calendar mr-2 text-blue-500"></i>
                                    <span>${new Date(race.date).toLocaleDateString('en-US', { 
                                        weekday: 'long', 
                                        year: 'numeric', 
                                        month: 'long', 
                                        day: 'numeric' 
                                    })}</span>
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-clock mr-2 text-green-500"></i>
                                    <span>${race.time} UTC</span>
                                </div>
                                <div class="flex items-center text-gray-300">
                                    <i class="fas fa-road mr-2 text-yellow-500"></i>
                                    <span>${race.circuit}</span>
                                </div>
                            </div>
                        `;
                        
                        // Update the small text above countdown timer
                        const raceInfoText = document.querySelector('.text-sm.text-gray-400.mb-6');
                        if (raceInfoText) {
                            raceInfoText.textContent = `${race.name} • ${race.location}`;
                        }
                        
                        // Debug: Log the race data received from API
                        console.log('Race data from API:', race);
                        console.log('Race date:', race.date);
                        console.log('Race time:', race.time);
                        
                        // Set up countdown timer
                        this.setupRaceCountdown(race.date, race.time);
                    }
                } catch (error) {
                    console.error('Error loading next race:', error);
                    // Fallback countdown for US GP
                    this.setupRaceCountdown('2025-10-19', '19:00:00Z');
                }
            }

            setupRaceCountdown(raceDate, raceTime) {
                // Parse the race date and time correctly
                let targetDate;
                
                // Expected format: date="2025-10-19", time="19:00:00Z"
                if (raceTime && raceTime.includes('Z')) {
                    // UTC time - construct ISO 8601 string
                    targetDate = new Date(`${raceDate}T${raceTime}`);
                } else if (raceTime) {
                    // Time without timezone, assume UTC
                    targetDate = new Date(`${raceDate}T${raceTime}Z`);
                } else {
                    // No time provided, use default race start time
                    targetDate = new Date(`${raceDate}T14:00:00Z`);
                }
                
                // Detailed debug logging
                console.log('=== COUNTDOWN DEBUG ===');
                console.log('Input - Race Date:', raceDate);
                console.log('Input - Race Time:', raceTime);
                console.log('Constructed Date String:', `${raceDate}T${raceTime}`);
                console.log('Target Date Object:', targetDate);
                console.log('Target Date (UTC):', targetDate.toUTCString());
                console.log('Target Date (Local):', targetDate.toLocaleString());
                console.log('Target Timestamp:', targetDate.getTime());
                console.log('Current Time:', new Date().toLocaleString());
                console.log('Current Timestamp:', new Date().getTime());
                console.log('======================');
                
                // Update the race name display
                const raceNameElement = document.getElementById('raceNameCountdown');
                if (raceNameElement && window.currentRaceName) {
                    raceNameElement.textContent = window.currentRaceName;
                }
                
                const updateCountdown = () => {
                    const now = new Date();
                    const timeDiff = targetDate.getTime() - now.getTime();
                    
                    console.log('Current Time:', now.toLocaleString());
                    console.log('Time Difference (ms):', timeDiff);
                    console.log('Time Difference (hours):', timeDiff / (1000 * 60 * 60));
                    
                    const daysElement = document.getElementById('countdownDays');
                    const hoursElement = document.getElementById('countdownHours');
                    const minutesElement = document.getElementById('countdownMinutes');
                    const secondsElement = document.getElementById('countdownSeconds');
                    const statusElement = document.getElementById('countdownStatus');
                    
                    if (!daysElement || !hoursElement || !minutesElement || !secondsElement) return;
                    
                    if (timeDiff <= 0) {
                        daysElement.textContent = '00';
                        hoursElement.textContent = '00';
                        minutesElement.textContent = '00';
                        secondsElement.textContent = '00';
                        if (statusElement) {
                            statusElement.textContent = 'RACE STARTED!';
                            statusElement.classList.add('text-green-500', 'font-bold');
                        }
                        return;
                    }
                    
                    const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
                    
                    // Animate the change
                    const updateWithAnimation = (element, newValue) => {
                        const oldValue = element.textContent;
                        if (oldValue !== newValue) {
                            element.style.transform = 'scale(1.1)';
                            element.style.color = '#ef4444';
                            setTimeout(() => {
                                element.textContent = newValue;
                                element.style.transform = 'scale(1)';
                                element.style.color = '';
                            }, 100);
                        }
                    };
                    
                    updateWithAnimation(daysElement, String(days).padStart(2, '0'));
                    updateWithAnimation(hoursElement, String(hours).padStart(2, '0'));
                    updateWithAnimation(minutesElement, String(minutes).padStart(2, '0'));
                    updateWithAnimation(secondsElement, String(seconds).padStart(2, '0'));
                    
                    // Debug logging every 10 seconds
                    if (seconds % 10 === 0) {
                        console.log(`Countdown: ${days}d ${hours}h ${minutes}m ${seconds}s (${Math.floor(timeDiff / (1000 * 60 * 60))} total hours)`);
                    }
                    
                    // Update status message based on time remaining
                    if (statusElement) {
                        if (days === 0 && hours < 1) {
                            statusElement.textContent = 'RACE STARTING SOON!';
                            statusElement.classList.add('text-yellow-500', 'font-bold', 'animate-pulse');
                        } else if (days === 0 && hours < 24) {
                            statusElement.textContent = 'RACE STARTS TODAY!';
                            statusElement.classList.add('text-green-500', 'font-bold');
                        } else {
                            statusElement.textContent = 'NEXT RACE COUNTDOWN';
                            statusElement.classList.remove('text-green-500', 'text-yellow-500', 'font-bold', 'animate-pulse');
                        }
                    }
                };
                
                updateCountdown(); // Run immediately
                if (this.countdownInterval) {
                    clearInterval(this.countdownInterval);
                }
                // Update every second for real-time countdown
                this.countdownInterval = setInterval(updateCountdown, 1000);
            }

            async loadUpcomingRaces() {
                try {
                    const response = await fetch('/api/race-schedule');
                    const data = await response.json();
                    
                    if (data.races && data.races.length > 0) {
                        const upcomingRaces = data.races.slice(0, 8); // Show next 8 races
                        document.getElementById('upcomingRaces').innerHTML = upcomingRaces.map(race => {
                            // Handle both UTC (with Z) and local time formats
                            let raceDateTime;
                            if (race.time && race.time.endsWith('Z')) {
                                // UTC time from API
                                raceDateTime = new Date(`${race.date}T${race.time}`);
                            } else {
                                // Assume local time
                                raceDateTime = new Date(`${race.date}T${race.time || '14:00:00'}`);
                            }
                            
                            // Convert to IST
                            const istTime = new Intl.DateTimeFormat('en-IN', {
                                timeZone: 'Asia/Kolkata',
                                hour: '2-digit',
                                minute: '2-digit',
                                hour12: true
                            }).format(raceDateTime);
                            
                            const istDate = new Intl.DateTimeFormat('en-IN', {
                                timeZone: 'Asia/Kolkata',
                                day: '2-digit',
                                month: 'short',
                                year: 'numeric'
                            }).format(raceDateTime);
                            
                            return `
                                <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50 hover:border-red-500/50 transition-all">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <h4 class="font-bold text-white text-sm mb-1">${race.name}</h4>
                                            <p class="text-xs text-gray-400 mb-2">${race.location || race.circuit}</p>
                                            <div class="flex items-center space-x-2">
                                                <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">${istDate}</span>
                                                <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">${istTime} IST</span>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center">
                                                <span class="text-xs font-bold text-white">${race.round}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `;
                        }).join('');
                    } else {
                        // Fallback with static upcoming races in IST
                        document.getElementById('upcomingRaces').innerHTML = `
                            <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50">
                                <h4 class="font-bold text-white text-sm mb-1">Australian Grand Prix</h4>
                                <p class="text-xs text-gray-400 mb-2">Melbourne, Australia</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">16 Mar 2025</span>
                                    <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">10:30 AM IST</span>
                                </div>
                            </div>
                            <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50">
                                <h4 class="font-bold text-white text-sm mb-1">Chinese Grand Prix</h4>
                                <p class="text-xs text-gray-400 mb-2">Shanghai, China</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">23 Mar 2025</span>
                                    <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">12:30 PM IST</span>
                                </div>
                            </div>
                            <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50">
                                <h4 class="font-bold text-white text-sm mb-1">Japanese Grand Prix</h4>
                                <p class="text-xs text-gray-400 mb-2">Suzuka, Japan</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">06 Apr 2025</span>
                                    <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">10:30 AM IST</span>
                                </div>
                            </div>
                            <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50">
                                <h4 class="font-bold text-white text-sm mb-1">Bahrain Grand Prix</h4>
                                <p class="text-xs text-gray-400 mb-2">Sakhir, Bahrain</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">13 Apr 2025</span>
                                    <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">08:30 PM IST</span>
                                </div>
                            </div>
                            <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50">
                                <h4 class="font-bold text-white text-sm mb-1">Saudi Arabian Grand Prix</h4>
                                <p class="text-xs text-gray-400 mb-2">Jeddah, Saudi Arabia</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">20 Apr 2025</span>
                                    <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">10:30 PM IST</span>
                                </div>
                            </div>
                            <div class="bg-gray-800/30 rounded-lg p-4 border border-gray-700/50">
                                <h4 class="font-bold text-white text-sm mb-1">Miami Grand Prix</h4>
                                <p class="text-xs text-gray-400 mb-2">Miami, USA</p>
                                <div class="flex items-center space-x-2">
                                    <span class="text-xs bg-red-600 px-2 py-1 rounded text-white font-mono">04 May 2025</span>
                                    <span class="text-xs bg-blue-600 px-2 py-1 rounded text-white font-mono">01:00 AM IST</span>
                                </div>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Error loading upcoming races:', error);
                    document.getElementById('upcomingRaces').innerHTML = `
                        <div class="text-center text-red-400">
                            Unable to load race schedule
                        </div>
                    `;
                }
            }

            async loadStandings() {
                try {
                    const response = await fetch('/api/standings');
                    const data = await response.json();
                    
                    if (data.drivers && data.constructors) {
                        // Driver Standings
                        document.getElementById('driverStandings').innerHTML = 
                            data.drivers.slice(0, 5).map((driver, index) => `
                                <div class="flex justify-between items-center p-2 bg-gray-800/50 rounded hover:bg-gray-700/50 transition-colors">
                                    <div class="flex items-center space-x-3">
                                        <span class="w-6 text-center font-mono text-sm ${index < 3 ? 'text-yellow-500' : 'text-gray-400'}">${driver.position}</span>
                                        <div>
                                            <div class="font-medium text-white">${driver.driver}</div>
                                            <div class="text-xs text-gray-400">${driver.team}</div>
                                        </div>
                                    </div>
                                    <span class="font-mono text-yellow-400">${driver.points}</span>
                                </div>
                            `).join('');

                        // Constructor Standings
                        document.getElementById('constructorStandings').innerHTML = 
                            data.constructors.slice(0, 5).map((constructor, index) => `
                                <div class="flex justify-between items-center p-2 bg-gray-800/50 rounded hover:bg-gray-700/50 transition-colors">
                                    <div class="flex items-center space-x-3">
                                        <span class="w-6 text-center font-mono text-sm ${index < 3 ? 'text-yellow-500' : 'text-gray-400'}">${constructor.position}</span>
                                        <span class="font-medium text-white">${constructor.team}</span>
                                    </div>
                                    <span class="font-mono text-yellow-400">${constructor.points}</span>
                                </div>
                            `).join('');
                    }
                } catch (error) {
                    console.error('Error loading standings:', error);
                }
            }

            async loadPredictions() {
                try {
                    const response = await fetch('/api/predictions');
                    const data = await response.json();
                    
                    if (data.predictions && data.predictions.length > 0) {
                        const winner = data.predictions[0];
                        const topContenders = data.predictions.slice(0, 5);
                        
                        // Winner Prediction
                        document.getElementById('winnerPrediction').innerHTML = `
                            <div class="bg-gradient-to-r from-red-500/20 to-transparent p-6 rounded-lg border border-red-500/30">
                                <div class="flex justify-between items-center mb-4">
                                    <div>
                                        <h4 class="f1-font text-2xl font-bold text-white">${winner.driver}</h4>
                                        <p class="text-gray-400">${winner.team}</p>
                                    </div>
                                    <div class="text-right">
                                        <div class="f1-font text-3xl font-bold text-red-500">${winner.probability}%</div>
                                        <div class="text-sm text-gray-400">CONFIDENCE</div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        // Top Contenders
                        document.getElementById('topContenders').innerHTML = topContenders.map((driver, index) => `
                            <div class="flex justify-between items-center p-3 bg-gray-800/50 rounded-lg hover:bg-gray-700/50 transition-colors">
                                <div class="flex items-center space-x-3">
                                    <span class="w-6 text-center font-mono text-sm text-gray-400">#${index + 1}</span>
                                    <div>
                                        <div class="font-medium text-white">${driver.driver}</div>
                                        <div class="text-xs text-gray-400">${driver.team}</div>
                                    </div>
                                </div>
                                <span class="font-mono text-green-400">${driver.probability}%</span>
                            </div>
                        `).join('');
                        
                        // Circuit Factors (placeholder)
                        document.getElementById('circuitFactors').innerHTML = `
                            <div class="grid grid-cols-3 gap-4 text-sm">
                                <div class="text-center">
                                    <div class="text-blue-500 font-bold">High Speed</div>
                                    <div class="text-gray-400">Corners</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-yellow-500 font-bold">Medium</div>
                                    <div class="text-gray-400">Overtaking</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-green-500 font-bold">Dry</div>
                                    <div class="text-gray-400">Weather</div>
                                </div>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Error loading predictions:', error);
                }
            }

            async loadLatestRaceResults() {
                try {
                    const response = await fetch('/api/last-race');
                    const data = await response.json();
                    
                    if (data.race && data.race.Results) {
                        const results = data.race.Results.slice(0, 5);
                        document.getElementById('latestRaceResults').innerHTML = `
                            <div class="mb-3">
                                <h4 class="font-bold text-white">${data.race.raceName}</h4>
                                <p class="text-sm text-gray-400">${new Date(data.race.date).toLocaleDateString()}</p>
                            </div>
                            ${results.map(result => `
                                <div class="flex justify-between items-center p-2 bg-gray-800/50 rounded hover:bg-gray-700/50 transition-colors">
                                    <div class="flex items-center space-x-3">
                                        <span class="w-6 text-center font-mono text-sm ${result.position <= 3 ? 'text-yellow-500' : 'text-gray-400'}">${result.position}</span>
                                        <div>
                                            <div class="font-medium text-white">${result.Driver.givenName} ${result.Driver.familyName}</div>
                                            <div class="text-xs text-gray-400">${result.Constructor.name}</div>
                                        </div>
                                    </div>
                                    <span class="text-xs text-gray-400">${result.Time ? result.Time.time : 'DNF'}</span>
                                </div>
                            `).join('')}
                        `;
                    }
                } catch (error) {
                    console.error('Error loading latest race results:', error);
                }
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new HomePageManager();
        });
    </script>
</body>
</html>